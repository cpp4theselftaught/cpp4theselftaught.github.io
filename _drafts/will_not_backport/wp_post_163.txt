ID: 180
post_author: 1
post_date: "2011-12-29 20:36:18"
post_date_gmt: "2011-12-30 01:36:18"
post_content: "n<div class="topsy_widget_data topsy_theme_blue" style="float: right;margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Frlc.vlinder.ca%252Fblog%252F2011%252F12%252Fsetting-up-a-new-skeleton-re-factoring%252F%22%2C%20%22shorturl%22%3A%20%22http%3A%2F%2Fbit.ly%2Ftpt6Md%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Setting%20up%20a%20new%20skeleton%3A%20re-factoring%20%23refactoring%22%20%7D);"></div>n<p> <audio id="wp_mep_1" src="http://vlinder.ca/podcasts/35-refactored.mp3" controls="controls" preload="none" >n n n n n n n n <object width="400" height="30" type="application/x-shockwave-flash" data="http://rlc.vlinder.ca/wp-content/plugins/media-element-html5-video-and-audio-player/mediaelement/flashmediaelement.swf">n <param name="movie" value="http://rlc.vlinder.ca/wp-content/plugins/media-element-html5-video-and-audio-player/mediaelement/flashmediaelement.swf" />n <param name="flashvars" value="controls=true&amp;file=http://vlinder.ca/podcasts/35-refactored.mp3" /> n </object> n </audio>n<script type="text/javascript">njQuery(document).ready(function($) {n $('#wp_mep_1').mediaelementplayer({n m:1n n ,features: ['playpause','current','progress','duration','volume','tracks','fullscreen']n ,audioWidth:400,audioHeight:30n });n});n</script>nBefore we go much further with our SOCKS server, we should do a bit of cleaning up in the project: we&#8217;ll move the <code>Server</code> and <code>Observer</code> classes to their own library, so we can more easily re-use them, and we&#8217;ll copy the <code>Application</code> class over to our new project &#8212; the one that will become our next step towards a fully functional SOCKS server: <em>Episode35</em>.<br />n<span id="more-1722"></span><br />nMost of the dreary details are clearly visible in the diff of the <span class="removed_link" title="https://gitorious.org/chausette/chausette/commit/209bb84/diffs">main commit</span> but a few interesting details show up when we compare the two <code>Application</code> classes:<br />n<div class="aside-toggler closed"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code closed"></p>n<pre lang="diff">--- bin/Episode28/Application.cpp 2011-09-26 19:58:52.938883900 -0400n+++ bin/Episode35/Application.cpp 2011-10-19 21:28:29.080693800 -0400n@@ -3,17 +3,51 @@n #include <boost/lexical_cast.hpp>n #include <iostream>n #include <vector>n+#include <ws2ipdef.h>n+#include <WinSock2.h>n #include "server/Server.h"n #include "config.h"n+#include "rfc1928/types.h"n n using namespace std;n using namespace boost;n n+struct Application::FDGuardn+{n+ FDGuard(int fd)n+ : fd_(fd)n+ , dismissed_(false)n+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old no-op */ }n+n+ ~FDGuard()n+ {n+ if (!dismissed_)n+ {n+ closesocket(fd_);n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old dismissed */ }n+ }n+n+ void dismiss()n+ {n+ dismissed_ = true;n+ }n+n+private :n+ FDGuard(const FDGuard&);n+ FDGuard& operator=(const FDGuard&);n+n+ int fd_;n+ bool dismissed_;n+};n+n Application::Application()n : server_(0)n-, data_to_send_attribute_id_(Socket::alloc())n-, target_address_attribute_id_(Socket::alloc())n-, un_paired_socket_(0)n+, socket_state_attribute_id_(Socket::alloc())n+, receive_buffer_attribute_id_(Socket::alloc())n+, send_buffer_attribute_id_(Socket::alloc())n+, socks_reply_attribute_id_(Socket::alloc())n {n WSADATA wsadata;n WSAStartup(MAKEWORD(2, 2), &wsadata);n@@ -29,8 +63,8 @@ void Application::run(const Application:n // for now, expect our own path in arguments[0], the IP address to n // listen on in arguments[1] and the port in arguments[2]n assert(arguments.size() >= 1);n- string ip(arguments.size() > 1 ? arguments[1] : CHAUSETTE_EPISODE28_DEFAULT_IP);n- unsigned short port(arguments.size() > 2 ? boost::lexical_cast< unsigned short >(arguments[2]) : CHAUSETTE_EPISODE28_DEFAULT_PORT);n+ string ip(arguments.size() > 1 ? arguments[1] : CHAUSETTE_EPISODE35_DEFAULT_IP);n+ unsigned short port(arguments.size() > 2 ? boost::lexical_cast< unsigned short >(arguments[2]) : CHAUSETTE_EPISODE35_DEFAULT_PORT);n sockaddr_storage address;n memset(&address, 0, sizeof(address));n sockaddr_in &in_address = reinterpret_cast< sockaddr_in&#038; >(address);n@@ -62,128 +96,405 @@ void Application::run(const Application:n /*virtual */void Application::onNewConnection(Socket &socket)n {n Socket &new_socket(server_->accept(socket));n- remote_address_to_socket_.insert(RemoteAddressToSocket::value_type(new_socket.remote_address_, &new_socket));n- pairSocket(new_socket);n+ new_socket.get(socket_state_attribute_id_) = expect_authentication_method_request__;n }n n /*virtual */void Application::onDataReady(Socket &socket)n {n- vector< char > temp; // in case the socket is un-pairedn- bool needed_to_initialize(false);n- vector< char >::size_type offset(0);n- Socket *partner((&socket == un_paired_socket_) ? 0 : remote_address_to_socket_[any_cast< sockaddr_storage >(socket.get(target_address_attribute_id_))]);n- if (partner &&n- partner->get(data_to_send_attribute_id_).empty())n+ if (socket.get(receive_buffer_attribute_id_).empty())n {n- partner->get(data_to_send_attribute_id_) = vector< char >(1024);n- needed_to_initialize = true;n+ socket.get(receive_buffer_attribute_id_) = Buffer(default_buffer_size__);n }n- else if (partner)n- { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old already have a buffer */ }n elsen- {n- temp.resize(1024);n- needed_to_initialize = true;n- }n- vector< char > &buffer = partner ? any_cast< vector< char >& >(partner->get(data_to_send_attribute_id_)) : temp;n- if (!needed_to_initialize && buffer.empty())n+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old already have a receive buffer */ }n+ Buffer &buffer(any_cast< Buffer&#038; >(socket.get(receive_buffer_attribute_id_)));n+ Buffer::size_type offset(0);n+ if (buffer.empty())n {n buffer.resize(buffer.capacity());n }n- else if (!needed_to_initialize)n+ elsen {n offset = buffer.size();n- if (buffer.capacity() <= offset + 1024)n+ if (buffer.capacity() - offset < minimal_available_buffer_size__)n {n- buffer.resize(offset + 1024);n+ buffer.resize(offset + minimal_available_buffer_size__);n }n elsen {n buffer.resize(buffer.capacity());n }n }n+ Buffer::size_type avail(buffer.size() - offset);n+ Buffer::pointer recv_ptr(&#038;(buffer[offset]));n+ server_->read(socket, recv_ptr, &avail);n+ buffer.resize(offset + avail);n+ // here, according to the state of the socket, dispatch the datan+ if (socket.get(socket_state_attribute_id_).empty())n+ {n+ socket.get(socket_state_attribute_id_) = expect_authentication_method_request__;n+ }n elsen- { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old needed to initialize - so no need to account for data already in the buffer */ }n- unsigned int data_read(buffer.size() - offset);n- char *read_ptr(&buffer[0]);n- read_ptr += offset;n- tryn+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old the socket already has a state */ }n+ switch (any_cast< SocketState >(socket.get(socket_state_attribute_id_).empty()))n {n- server_->read(socket, read_ptr, &data_read);n- buffer.resize(offset + data_read);n- unsigned int data_written(buffer.size());n- if (partner)n+ case expect_authentication_method_request__ :n+ onAuthenticationMethodRequest(socket);n+ break;n+ case expect_socks_request__ :n+ onSocksRequest(socket);n+ break;n+ }n+}n+n+/*virtual */void Application::onWriteReady(Socket &socket)n {n- server_->write(*partner, &buffer[0], &data_written);n+ if (!socket.get(send_buffer_attribute_id_).empty())n+ {n+ Buffer &buffer(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n+ Buffer::size_type offset(0);n+ if (!buffer.empty())n+ {n+ Buffer::size_type avail(buffer.size());n+ Buffer::pointer send_ptr(&(buffer[0]));n+ server_->write(socket, send_ptr, &avail);n+ buffer.erase(buffer.begin(), buffer.begin() + avail);n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old nothing to send */ }n }n elsen- { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old no partner to send data to */ }n- buffer.erase(buffer.begin(), buffer.begin() + data_written);n+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old nothing to send */ }n }n- catch (const Server::NetworkError&)n+n+/*virtual */void Application::onExceptionalDataReady(Socket &socket)n {n- // ignore this for now: the socket will have been dealt with but this is no reason for us to crash.n }n+n+/*virtual */void Application::onCloseSocket(Socket &socket)n+{n }n n-/*virtual */void Application::onWriteReady(Socket &socket)n+void Application::onAuthenticationMethodRequest(Socket &socket) constn {n- if (socket.get(data_to_send_attribute_id_).empty())n- { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old no-op */ }n+ using Vlinder::Chausette::RFC1928::VersionIdentifierMethodSelectionMessage;n+ using Vlinder::Chausette::RFC1928::MethodMessage;n+ Buffer &buffer(any_cast< Buffer&#038; >(socket.get(receive_buffer_attribute_id_)));n+ if (buffer.size() < offsetof(VersionIdentifierMethodSelectionMessage, methods_) + 1)n+ {n+ throw InsufficientData("Not enough data for a version identifier/method selection message");n+ }n elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ VersionIdentifierMethodSelectionMessage *message(reinterpret_cast< VersionIdentifierMethodSelectionMessage* >(&buffer[0]));n+ if (message->ver_ != CHAUSETTE_EPISODE35_SOCKS_VERSION)n {n- vector< char > &buffer = any_cast< vector< char >& >(socket.get(data_to_send_attribute_id_));n- if (buffer.empty())n- { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old no-op */ }n+ throw WrongSocksVersion("Wrong socks version", CHAUSETTE_EPISODE35_SOCKS_VERSION, message->ver_);n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old the version is OK */ }n+ if (buffer.size() < offsetof(VersionIdentifierMethodSelectionMessage, methods_) + message->nmethods_)n+ {n+ throw InsufficientData("Not enough data for a version identifier/method selection message");n+ }n elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old As we haven't implemented any authentication methods yet, we only n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml support "no authentication" - method 0. If it is not present among n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml the methods, throw an exception. */n+ bool authentication_ok(false);n+ for (unsigned char *method = message->methods_; !authentication_ok &&<sup><a href="http://rlc.vlinder.ca/blog/2011/12/setting-up-a-new-skeleton-re-factoring/#footnote_0_1722" id="identifier_0_1722" class="footnote-link footnote-identifier-link" title="method - message-&gt;methods_) &lt; message-&gt;nmethods_); ++method)n {n- unsigned int data_written(buffer.size(">1</a></sup>;n- server_->write(socket, &buffer[0], &data_written);n- buffer.erase(buffer.begin(), buffer.begin() + data_written);n+ authentication_ok = (*method == 0);n }n+ if (!authentication_ok)n+ {n+ throw NoSupportedAuthenticationMethod("No supported authentication method");n }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well */ }n+ MethodMessage methodMessage(CHAUSETTE_EPISODE35_SOCKS_VERSION, 0/* no authentication - put a constant here later */);n+ unsigned char *ptr(reinterpret_cast< unsigned char* >(&methodMessage));n+ queueDataToSend(socket, ptr, ptr + sizeof(methodMessage));n }n n-/*virtual */void Application::onExceptionalDataReady(Socket &socket)n+void Application::onSocksRequest(Socket &socket)n {n+ using Vlinder::Chausette::RFC1928::SocksRequest;n+ Buffer &buffer(any_cast< Buffer&#038; >(socket.get(receive_buffer_attribute_id_)));n+ if (buffer.size() < offsetof(SocksRequest, dst_addr_) + 1)n+ {n+ throw InsufficientData("Not enough data for a SOCKS request");n }n-n-/*virtual */void Application::onCloseSocket(Socket &#038;socket)n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ SocksRequest *message(reinterpret_cast< SocksRequest* >(&buffer[0]));n+ if (message->ver_ != CHAUSETTE_EPISODE35_SOCKS_VERSION)n {n- RemoteAddressToSocket::iterator where(remote_address_to_socket_.find(socket.remote_address_));n- assert(where != remote_address_to_socket_.end());n- assert(where->second == &socket);n- remote_address_to_socket_.erase(where);n- unpairSocket(socket);n+ throw WrongSocksVersion("Wrong SOCKS version", CHAUSETTE_EPISODE35_SOCKS_VERSION, message->ver_);n }n-n-void Application::pairSocket(Socket &socket)n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old the version is OK */ }n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old Inside the message, the port field is the only one that isn't n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml necessarily in the same position as in the struct. The othern+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml fields are where they should be - and we can get to the port n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml field by pasing the address type field. */n+ sockaddr_storage address;n+ memset(&address, 0, sizeof(address));n+ switch (message->atyp_)n {n- if (un_paired_socket_)n+ case 1 :n {n- un_paired_socket_->get(target_address_attribute_id_) = socket.remote_address_;n- socket.get(target_address_attribute_id_) = un_paired_socket_->remote_address_;n- un_paired_socket_ = 0;n+ // IP V4 address: X'01'n+ if (buffer.size() < offsetof(SocksRequest, dst_addr_) + 6 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old four for the address, two for the port */)n+ {n+ throw InsufficientData("Not enough data for a SOCKS request");n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ address.ss_family = AF_INET;n+ sockaddr_in *a4(reinterpret_cast< sockaddr_in* >(&address));n+ memcpy(&a4->sin_addr, message->dst_addr_, 4);n+ memcpy(&a4->sin_port, message->dst_addr_ + 4, 2);n+ break;n+ }n+ case 3 :n+ {n+ // DOMAINNAME: X'03'n+ unsigned char hostname_length(message->dst_addr_[0]);n+ if (buffer.size() < offsetof(SocksRequest, dst_addr_) + hostname_length + 2 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old hostname_length for the address, two for the port */)n+ {n+ throw InsufficientData("Not enough data for a SOCKS request");n }n elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ char *hostname_begin(reinterpret_cast< char* >(message->dst_addr_ + 1));n+ char *hostname_end = hostname_begin + hostname_length;n+ unsigned short port(*reinterpret_cast< unsigned short* >(hostname_end));n+ *hostname_end = 0; // cap it offn+ hostent *host_entry(gethostbyname(hostname_begin));n+ if (!host_entry)n {n- un_paired_socket_ = &socket;n+ throw NameResolutionError("Name resolution error", GetLastError());n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old resolved OK */ }n+ switch (host_entry->h_addrtype)n+ {n+ case AF_INET :n+ {n+ sockaddr_in *a4(reinterpret_cast< sockaddr_in* >(&address));n+ memcpy(&a4->sin_addr, host_entry->h_addr_list[0], 4);n+ a4->sin_port = port;n+ break;n+ }n+ case AF_INET6 :n+ {n+ sockaddr_in6 *a6(reinterpret_cast< sockaddr_in6* >(&address));n+ memcpy(&a6->sin6_addr, host_entry->h_addr_list[0], 16);n+ a6->sin6_port = port;n+ break;n+ }n }n+ break;n }n+ case 4 :n+ {n+ // IP V6 address: X'04'n+ if (buffer.size() < offsetof(SocksRequest, dst_addr_) + 16 + 2 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old four for the address, two for the port */)n+ {n+ throw InsufficientData("Not enough data for a SOCKS request");n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ address.ss_family = AF_INET6;n+ sockaddr_in6 *a6(reinterpret_cast< sockaddr_in6* >(&address));n+ memcpy(&a6->sin6_addr, message->dst_addr_, 16);n+ memcpy(&a6->sin6_port, message->dst_addr_ + 16, 2);n+ break;n+ }n+ default :n+ throw UnknownAddressType("Unknown address type", message->atyp_);n+ }n+ switch (message->cmd_)n+ {n+ case 1 :n+ // CONNECT X'01'n+ doConnect(socket, address);n+ break;n+ case 2 :n+ // BIND X'02' //TODOn+ case 3 :n+ // UDP ASSOCIATE X'03' //TODOn+ break;n+ }n+}n+n+void Application::doConnect(Socket &parent_socket, const sockaddr_storage &address)n+{n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old In the reply to a CONNECT, BND.PORT contains the port number that then+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml server assigned to connect to the target host, while BND.ADDRn+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml contains the associated IP address. The supplied BND.ADDR is oftenn+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml different from the IP address that the client uses to reach the SOCKSn+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml server, since such servers are often multi-homed. It is expectedn+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml that the SOCKS server will use DST.ADDR and DST.PORT, and then+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml client-side source address and port in evaluating the CONNECTn+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml request. */n+ using Vlinder::Chausette::RFC1928::SocksReply;n+ SocksReply reply;n+ memset(&reply, 0, sizeof(reply));n+ reply.ver_ = CHAUSETTE_EPISODE35_SOCKS_VERSION;n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old attempt to connect to the target address. If successful, open a n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml server socket for the client to connect to, and forward the datan+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml between the two. */n+ int sock_fd(::socket(address.ss_family, SOCK_STREAM, IPPROTO_TCP));n+ if (sock_fd == INVALID_SOCKET)n+ {n+ reply.rep_ = 1; // X'01' general SOCKS server failuren+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well */ }n+ FDGuard fd_guard(sock_fd);n+ u_long arg(1);n+ if (ioctlsocket(sock_fd, FIONBIO, &arg) != 0)n+ {n+ reply.rep_ = 1; // X'01' general SOCKS server failuren+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ throw SocketIOCTLFailed("Failed to set socket to non-blocking", WSAGetLastError());n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n+ if (connect(sock_fd, (const sockaddr*)&address, sizeof(address)) != 0)n+ {n+ unsigned long last_error(WSAGetLastError());n+ switch (last_error)n+ {n+ // logic errorsn+ case WSANOTINITIALISED :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old A successful WSAStartup call must occur before using this function. */n+ case WSAEADDRINUSE :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The socket's local address is already in use and the socket was not n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml marked to allow address reuse with SO_REUSEADDR. This error usually n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml occurs when executing bind, but could be delayed until the connect n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml function if the bind was to a wildcard address (INADDR_ANY or n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml in6addr_any) for the local IP address. A specific address needs to n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml be implicitly bound by the connect function. */n+ case WSAEINTR :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The blocking Windows Socket 1.1 call was canceled through n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml WSACancelBlockingCall. */n+ case WSAEINPROGRESS :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old A blocking Windows Sockets 1.1 call is in progress, or the service n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml provider is still processing a callback function. */n+ case WSAEALREADY :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old A nonblocking connect call is in progress on the specified socket.n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml Note In order to preserve backward compatibility, this error is reported n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml as WSAEINVAL to Windows Sockets 1.1 applications that link to either n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml Winsock.dll or Wsock32.dll. */n+ case WSAEAFNOSUPPORT :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old Addresses in the specified family cannot be used with this socket. */n+ case WSAEINVAL :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The parameter s is a listening socket. */n+ case WSAEISCONN :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The socket is already connected (connection-oriented sockets only). */n+ case WSAENOTSOCK :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The descriptor specified in the s parameter is not a socket. */n+ case WSAEACCES :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old An attempt to connect a datagram socket to broadcast address failed n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml because setsockopt option SO_BROADCAST is not enabled. */n+ default :n+ reply.rep_ = 1; // X'01' general SOCKS server failuren+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ throw ConnectError("Internal error calling connect", last_error);n+n+ // run-time errors outside the caller's controln+ case WSAENETDOWN :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The network subsystem has failed. */n+ reply.rep_ = 1; // X'01' general SOCKS server failuren+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+ case WSAECONNREFUSED :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The attempt to connect was forcefully rejected. */n+ reply.rep_ = 5; // X'05' Connection refusedn+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+ case WSAENETUNREACH :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The network cannot be reached from this host at this time. */n+ reply.rep_ = 3; // X'03' Network unreachablen+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+ case WSAEHOSTUNREACH :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old A socket operation was attempted to an unreachable host. */n+ reply.rep_ = 4; // X'04' Host unreachablen+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+ case WSAENOBUFS :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old Note No buffer space is available. The socket cannot be connected. */n+ reply.rep_ = 1; // X'01' general SOCKS server failuren+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+ case WSAETIMEDOUT :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old An attempt to connect timed out without establishing a connection. */n+ reply.rep_ = 6; // X'06' TTL expiredn+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+n+ // run-time errors that point to bugs in the caller/clientn+ case WSAEADDRNOTAVAIL :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The remote address is not a valid address (such as INADDR_ANY or in6addr_any) . */n+ case WSAEFAULT :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The sockaddr structure pointed to by the name contains incorrect address format n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml for the associated address family or the namelen parameter is too small. This error n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml is also returned if the sockaddr structure pointed to by the name parameter with n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml a length specified in the namelen parameter is not in a valid part of the user n+ 2017-10-14-new-website.md 2017-10-14-new-website.md~ split.sh split.sh~ wp_post_100.txt wp_post_101.txt wp_post_102.txt wp_post_103.txt wp_post_104.txt wp_post_105.txt wp_post_106.txt wp_post_107.txt wp_post_108.txt wp_post_109.txt wp_post_10.txt wp_post_110.txt wp_post_111.txt wp_post_112.txt wp_post_113.txt wp_post_114.txt wp_post_115.txt wp_post_116.txt wp_post_117.txt wp_post_118.txt wp_post_119.txt wp_post_11.txt wp_post_120.txt wp_post_121.txt wp_post_122.txt wp_post_123.txt wp_post_124.txt wp_post_125.txt wp_post_126.txt wp_post_127.txt wp_post_128.txt wp_post_129.txt wp_post_12.txt wp_post_130.txt wp_post_131.txt wp_post_132.txt wp_post_133.txt wp_post_134.txt wp_post_135.txt wp_post_136.txt wp_post_137.txt wp_post_138.txt wp_post_139.txt wp_post_13.txt wp_post_140.txt wp_post_141.txt wp_post_142.txt wp_post_143.txt wp_post_144.txt wp_post_145.txt wp_post_146.txt wp_post_147.txt wp_post_148.txt wp_post_149.txt wp_post_14.txt wp_post_150.txt wp_post_151.txt wp_post_152.txt wp_post_153.txt wp_post_154.txt wp_post_155.txt wp_post_156.txt wp_post_157.txt wp_post_158.txt wp_post_159.txt wp_post_15.txt wp_post_160.txt wp_post_161.txt wp_post_162.txt wp_post_163.txt wp_post_16.txt wp_post_17.txt wp_post_18.txt wp_post_19.txt wp_post_1.yml wp_post_20.txt wp_post_21.txt wp_post_22.txt wp_post_23.txt wp_post_24.txt wp_post_25.txt wp_post_26.txt wp_post_27.txt wp_post_28.txt wp_post_29.txt wp_post_2.txt wp_post_30.txt wp_post_31.txt wp_post_32.txt wp_post_33.txt wp_post_34.txt wp_post_35.txt wp_post_36.txt wp_post_37.txt wp_post_38.txt wp_post_39.txt wp_post_3.txt wp_post_40.txt wp_post_41.txt wp_post_42.txt wp_post_43.txt wp_post_44.txt wp_post_45.txt wp_post_46.txt wp_post_47.txt wp_post_48.txt wp_post_49.txt wp_post_4.txt wp_post_50.txt wp_post_51.txt wp_post_52.txt wp_post_53.txt wp_post_54.txt wp_post_55.txt wp_post_56.txt wp_post_57.txt wp_post_58.txt wp_post_59.txt wp_post_5.txt wp_post_60.txt wp_post_61.txt wp_post_62.txt wp_post_63.txt wp_post_64.txt wp_post_65.txt wp_post_66.txt wp_post_67.txt wp_post_68.txt wp_post_69.txt wp_post_6.txt wp_post_70.txt wp_post_71.txt wp_post_72.txt wp_post_73.txt wp_post_74.txt wp_post_75.txt wp_post_76.txt wp_post_77.txt wp_post_78.txt wp_post_79.txt wp_post_7.txt wp_post_80.txt wp_post_81.txt wp_post_82.txt wp_post_83.txt wp_post_84.txt wp_post_85.txt wp_post_86.txt wp_post_87.txt wp_post_88.txt wp_post_89.txt wp_post_8.txt wp_post_90.txt wp_post_91.txt wp_post_92.txt wp_post_93.txt wp_post_94.txt wp_post_95.txt wp_post_96.txt wp_post_97.txt wp_post_98.txt wp_post_99.txt wp_post_9.txt wp_posts.yml address space. */n+ reply.rep_ = 8; // X'08' Address type not supportedn+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, send_socks_reply__);n+ break;n+n+ // "normal" errorsn+ case WSAEWOULDBLOCK :n+ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old The socket is marked as nonblocking and the connection cannot be completed immediately. */n+ parent_socket.get(socks_reply_attribute_id_) = reply;n+ setSocketState(parent_socket, wait_socks_reply__);n+ break;n+ }n+ }n+ elsen+ { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well */ }n+}n+n+void Application::setSocketState(Socket &socket, Application::SocketState state)n+{n+ SocketState current_state(any_cast< SocketState >(socket.get(socket_state_attribute_id_)));n+ //TODOn+}n+n n-void Application::unpairSocket(Socket &socket)n+void Application::queueDataToSend(Socket &socket, unsigned char *begin, unsigned char *end) constn {n- // find the socket this one was paired ton- if (un_paired_socket_ == &socket)n+ Buffer *buffer(0);n+ if (!socket.get(send_buffer_attribute_id_).empty())n {n- un_paired_socket_ = 0;n+ buffer = &(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n }n elsen {n- assert(!socket.get(target_address_attribute_id_).empty());n- sockaddr_storage target_address(any_cast< sockaddr_storage >(socket.get(target_address_attribute_id_)));n- Socket *other_socket(remote_address_to_socket_[target_address]);n other_socket->get(target_address_attribute_id_) = any();n- pairSocket(*other_socket);n+ socket.get(send_buffer_attribute_id_) = Buffer();n+ buffer = &(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n }n+ copy(begin, end, back_inserter(*buffer));n+ unsigned int data(buffer->size());n+ server_->write(socket, &((*buffer)[0]), &data);n+ buffer->erase(buffer->begin(), buffer->begin() + data);n }</pre>n<p></div></p>n<p>We are going to have to manage different kinds of sockets: sockets for command-and-control (which we will call &#8220;control sockets&#8221; from here on) and sockets that need to be proxied. At first, we&#8217;ll just do TCP proxying but, eventually, we will also proxy UDP.</p>n<p>The way this is going to work, we will have only one thread to do most of the work &#8212; so we&#8217;ll have to be relatively smart about multiplexing our work. In this context, multiplexing means that we tell the sockets API &#8212; and therefore the underlying TCP/IP stack &#8212; what we want it to do, but we don&#8217;t wait around for it to perform its tasks: rather, we tell it to notify us whenever a task is finished and will carry it on from there. For that to work we do, of course, need to know what task it was performing. We do that by associating a <em>state</em> with each socket, which we put in one of the attributes, which we will call <code>socket_state_attribute_id_</code>. That attribute is allocated in the constructor and used throughout the code. For example, in <code>onDataReady</code>, it is used to know what to do with the incoming data:</p>n<div class="aside-toggler closed"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code closed"></p>n<pre lang="cpp" line="132">// here, according to the state of the socket, dispatch the datanif (socket.get(socket_state_attribute_id_).empty())n{n socket.get(socket_state_attribute_id_) = expect_authentication_method_request__;n}nelsen{ /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old the socket already has a state */ }nswitch (any_cast< SocketState >(socket.get(socket_state_attribute_id_).empty()))n{ncase expect_authentication_method_request__ :n onAuthenticationMethodRequest(socket);n break;ncase expect_socks_request__ :n onSocksRequest(socket);n break;n}</pre>n<p></div>n<p>This basically turns the socket itself into a <a href="http://rlc.vlinder.ca/blog/2010/01/error-handling-in-c/" title="state machines, and error handling, in C" >state machine</a>. The available states would, of course, be different according to the role of the socket (i.e. a data socket would never be expected to send a SOCKS request).</p>n<p>We will look into state machines in the next installment.</p>n<p>Another important/interesting part of the new code is the parsing of SOCKS requests. We will look at the actions they imply later, but we will take a closer look at the parsing now:</p>n<p>The first step is to read the data from the buffer. If there isn&#8217;t enough data in the buffer, the request cannot be parsed and should be set aside. Some preliminary checks can be performed on the request immediately, as the following snippet of code will show:<br />n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="181">void Application::onAuthenticationMethodRequest(Socket &socket) constn{n using Vlinder::Chausette::RFC1928::VersionIdentifierMethodSelectionMessage;n using Vlinder::Chausette::RFC1928::MethodMessage;n Buffer &buffer(any_cast< Buffer&#038; >(socket.get(receive_buffer_attribute_id_)));n if (buffer.size() < offsetof(VersionIdentifierMethodSelectionMessage, methods_) + 1)n {n throw InsufficientData("Not enough data for a version identifier/method selection message");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n</pre>n<p></div></p>n<p>Now that we know we at least have enough data, we can treat the data as a message and, assuming the data in the buffer is either properly aligned, or we don't care about the alignment, we can simply cast the buffer to the appropriate message type and do some more preliminary checks:</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="192"> VersionIdentifierMethodSelectionMessage *message(reinterpret_cast< VersionIdentifierMethodSelectionMessage* >(&buffer[0]));n if (message->ver_ != CHAUSETTE_EPISODE35_SOCKS_VERSION)n {n throw WrongSocksVersion("Wrong socks version", CHAUSETTE_EPISODE35_SOCKS_VERSION, message->ver_);n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old the version is OK */ }n unsigned int message_size(offsetof(VersionIdentifierMethodSelectionMessage, methods_) + message->nmethods_);n if (buffer.size() < message_size)n {n throw InsufficientData("Not enough data for a version identifier/method selection message");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }</pre>n<p></div>n<p>In this specific message, we're setting up an authentication method - we won't support authentication right away, so for now, only method <code>0</code> is supported. According to the protocol, this means that at least one of the proposed authentication methods, of which there can be up to 255, has to be <code>0</code>.</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="209"> bool authentication_ok(false);n for (unsigned char *method = message->methods_; !authentication_ok &&<sup><a href="http://rlc.vlinder.ca/blog/2011/12/setting-up-a-new-skeleton-re-factoring/#footnote_1_1722" id="identifier_1_1722" class="footnote-link footnote-identifier-link" title="method - message-&gt;methods_) &lt; message-&gt;nmethods_); ++method)n {n authentication_ok = (*method == 0);n }n if (!authentication_ok)n {n throw NoSupportedAuthenticationMethod(&quot;No supported authentication method&quot;);n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well */ }nnOnce we&#039;ve established that we can, indeed, authenticate (or rather: that we don&#039;t need to) we can set up our reply, and send it.nTo see the code click here.To hide the code click here.n n MethodMessage method_message(CHAUSETTE_EPISODE35_SOCKS_VERSION, 0/* no authentication - put a constant here later */);n unsigned char *ptr(reinterpret_cast&lt; unsigned char* &gt;(&amp;method_message">2</a></sup>;n queueDataToSend(socket, ptr, ptr + sizeof(method_message));</pre>n<p></div>n<p>Then, we set the state of the socket to one in which we expect SOCKS requests -- now that the initial handshaking is done -- and consume the data we've already handled.</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="223"> socket.get(socket_state_attribute_id_) = expect_socks_request__;n buffer.erase(buffer.begin(), buffer.begin() + message_size);</pre>n<p></div>n<p>SOCKS requests are handled pretty much the same way, but contain an address -- the IP address of the host we will be proxying with. According to the address type, there are different ways to extract the IP address of the host we will be proxying with. It can either contain the actual IPv4 address, as in the next bit of code:<br />n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="242"> sockaddr_storage address;n memset(&address, 0, sizeof(address));n switch (message->atyp_)n {n case 1 :n {n // IP V4 address: X'01'n if (buffer.size() < offsetof(SocksRequest, dst_addr_) + 6 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old four for the address, two for the port */)n {n throw InsufficientData("Not enough data for a SOCKS request");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n address.ss_family = AF_INET;n sockaddr_in *a4(reinterpret_cast< sockaddr_in* >(&address));n memcpy(&a4->sin_addr, message->dst_addr_, 4);n memcpy(&a4->sin_port, message->dst_addr_ + 4, 2);n break;n }</pre>n<p></div><br />nor it can be a domain name, in which case the address has to be looked up.</p>n<p>Address lookup is done synchronously, using <code>gethostbyname</code>, but should eventually be done asynchronously as calling this function may take some time -- time we don't necessarily want to spend waiting.</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="261"> case 3 :n {n // DOMAINNAME: X'03'n unsigned char hostname_length(message->dst_addr_[0]);n if (buffer.size() < offsetof(SocksRequest, dst_addr_) + hostname_length + 2 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old hostname_length for the address, two for the port */)n {n throw InsufficientData("Not enough data for a SOCKS request");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n char *hostname_begin(reinterpret_cast< char* >(message->dst_addr_ + 1));n char *hostname_end = hostname_begin + hostname_length;n unsigned short port(*reinterpret_cast< unsigned short* >(hostname_end));n *hostname_end = 0; // cap it offn hostent *host_entry(gethostbyname(hostname_begin));n if (!host_entry)n {n throw NameResolutionError("Name resolution error", GetLastError());n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old resolved OK */ }n switch (host_entry->h_addrtype)n {n case AF_INET :n {n sockaddr_in *a4(reinterpret_cast< sockaddr_in* >(&address));n memcpy(&a4->sin_addr, host_entry->h_addr_list[0], 4);n a4->sin_port = port;n break;n }n case AF_INET6 :n {n sockaddr_in6 *a6(reinterpret_cast< sockaddr_in6* >(&address));n memcpy(&a6->sin6_addr, host_entry->h_addr_list[0], 16);n a6->sin6_port = port;n break;n }n }n break;n }</pre>n<p></div>n<p>The address can also be an IPv6, in which case, like in the case of an IPv4 address, it is simply copied.</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="301"> case 4 :n {n // IP V6 address: X'04'n if (buffer.size() < offsetof(SocksRequest, dst_addr_) + 16 + 2 /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old four for the address, two for the port */)n {n throw InsufficientData("Not enough data for a SOCKS request");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well so far */ }n address.ss_family = AF_INET6;n sockaddr_in6 *a6(reinterpret_cast< sockaddr_in6* >(&address));n memcpy(&a6->sin6_addr, message->dst_addr_, 16);n memcpy(&a6->sin6_port, message->dst_addr_ + 16, 2);n break;n }n default :n throw UnknownAddressType("Unknown address type", message->atyp_);n }</pre>n<p></div>n<p>There are a few things you should notice: invalid IP addresses and domain names are not necessarily a problem -- they won't work, of course, but there is really no other way to check for them than to try them out. The only thing we really check is that there's enough data in the request to contain the information being extracted from the request.</p>n<p>Socks requests are fairly simple and don't contain anything like checksums or cryptographic authentication (although cryptographic authentication can be part of the protocol, if supported by both sides) so other than these few checks, there is really nothing to be done.</p>n<p>Queueing data to send looks like this:<br />n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="503">void Application::queueDataToSend(Socket &socket, unsigned char *begin, unsigned char *end) constn{n Buffer *buffer(0);n if (!socket.get(send_buffer_attribute_id_).empty())n {n buffer = &(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n }n elsen {n socket.get(send_buffer_attribute_id_) = Buffer();n buffer = &(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n }n copy(begin, end, back_inserter(*buffer));n unsigned int data(buffer->size());n server_->write(socket, &((*buffer)[0]), &data);n buffer->erase(buffer->begin(), buffer->begin() + data);n}</pre>n<p></div></p>n<p>First thing we do is get a buffer to put the data into. That buffer is associated with the socket itself so that, if the socket isn't ready for data being written to it, we can write the data to the socket when the socket <em>is</em> ready, in <code>onWriteReady</code>. The <code>Server</code> code will know what to do with a call to <code>write</code> if the socket isn't ready, so we can simply call it and remove, from the buffer, any data that we could send.</p>n<p>The <code>onWriteReady</code> method is similar, of course:<br />n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="152">/*virtual */void Application::onWriteReady(Socket &socket)n{n if (!socket.get(send_buffer_attribute_id_).empty())n {n Buffer &buffer(any_cast< Buffer&#038; >(socket.get(send_buffer_attribute_id_)));n Buffer::size_type offset(0);n if (!buffer.empty())n {n Buffer::size_type avail(buffer.size());n Buffer::pointer send_ptr(&(buffer[0]));n server_->write(socket, send_ptr, &avail);n buffer.erase(buffer.begin(), buffer.begin() + avail);n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old nothing to send */ }n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old nothing to send */ }n}</pre>n<p></div></p>n<p>As you can see, it simply retrieves the buffer if there is one and sends as much of the available data as possible.</p>n<p>In the next few installments, we will look at the following:</p>n<ol>n<li><strong>state machines</strong>: as mentioned above, every socket will be construed as a state machine -- but we will look at state machines in other contexts as well.</li>n<li><strong>threads</strong>: as mentioned above, some actions (such as DNS queries) will need to be performed asynchronously. We will do that by creating a thread to handle those requests.</li>n<li><strong>the Command pattern</strong> which we'll be using to communicate with the thread</li>n</ol>nn<ol class="footnotes"><li id="footnote_0_1722" class="footnote">method - message->methods_) < message->nmethods_); ++method)n {n- unsigned int data_written(buffer.size(</li><li id="footnote_1_1722" class="footnote">method - message->methods_) < message->nmethods_); ++method)n {n authentication_ok = (*method == 0);n }n if (!authentication_ok)n {n throw NoSupportedAuthenticationMethod("No supported authentication method");n }n elsen { /bin /boot /cdrom /dev /etc /home /initrd.img /initrd.img.old /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /sys /tmp /usr /var /vmlinuz /vmlinuz.old all is well */ }</pre>n<p></div>n<p>Once we've established that we can, indeed, authenticate (or rather: that we don't need to) we can set up our reply, and send it.</p>n<div class="aside-toggler open"><span class="open-aside code">To see the <em>code</em> click here.</span><span class="close-aside code">To hide the <em>code</em> click here.</span>n </div><div class="bnsia aside code open"></p>n<pre lang="cpp" line="220"> MethodMessage method_message(CHAUSETTE_EPISODE35_SOCKS_VERSION, 0/* no authentication - put a constant here later */);n unsigned char *ptr(reinterpret_cast< unsigned char* >(&method_message</li></ol>"
post_title: "Setting up a new skeleton: re-factoring"
post_excerpt: "Before we go much further with our SOCKS server, we should do a bit of cleaning up in the project: we&rsquo;ll move the Server and Observer classes to their own library, so we can more easily re-use them, and we&rsquo;ll &hellip; <a href="http://rlc.vlinder.ca/blog/2011/12/setting-up-a-new-skeleton-re-factoring/">Continue reading <span>&rarr;</span></a>"
post_status: "inherit"
comment_status: "closed"
ping_status: "closed"
post_password: ""
post_name: "35-revision-v1"
to_ping: ""
pinged: ""
post_modified: "2011-12-29 20:36:18"
post_modified_gmt: "2011-12-30 01:36:18"
post_content_filtered: ""
post_parent: 35
guid: "http://feedwordpress.radgeek.com/?rev=c294d76cef0418cec934084e1920c23d"
menu_order: 0
post_type: "revision"
post_mime_type: ""
comment_count: 0
